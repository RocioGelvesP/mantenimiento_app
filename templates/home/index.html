<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Incluir Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Página de Inicio</title>
    <style> 
        :root {
            --primary-color: #022141;
            --secondary-color: #00bcd4;
            --accent-color: #ff9800;
            --success-color: #4caf50;
            --warning-color: #ff9800;
            --danger-color: #f44336;
            --light-bg: #f8f9fa;
            --dark-bg: #343a40;
            --gradient-primary: linear-gradient(135deg, #022141 0%, #01376d 100%);
            --gradient-secondary: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
            --gradient-success: linear-gradient(135deg, #4caf50 0%, #388e3c 100%);
            --gradient-warning: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            --gradient-info: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
        }

        body { 
          background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          margin: 0;
          padding: 0;
          min-height: 100vh;
          font-size: 11px;
        }

        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
            pointer-events: none;
        }

        .shape {
            position: absolute;
            background: linear-gradient(135deg, rgba(0, 188, 212, 0.05) 0%, rgba(2, 33, 65, 0.03) 100%);
            border-radius: 50%;
            animation: float 8s ease-in-out infinite;
        }

        .shape:nth-child(1) {
            width: 60px;
            height: 60px;
            top: 15%;
            left: 5%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 80px;
            height: 80px;
            top: 70%;
            right: 5%;
            animation-delay: 3s;
        }

        .shape:nth-child(3) {
            width: 40px;
            height: 40px;
            bottom: 15%;
            left: 15%;
            animation-delay: 6s;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
            }
            50% {
                transform: translateY(-15px) rotate(180deg);
            }
        }

        .navbar { 
            background: var(--gradient-primary) !important; 
            padding: 0.25rem;
            box-shadow: 0 1px 4px rgba(2, 33, 65, 0.3);
        }

        .navbar-brand { 
            color: white !important; 
            font-size: 1.1rem; 
            font-weight: bold; 
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .nav-link { 
            color: rgba(255,255,255,0.9) !important; 
            font-size: 0.8rem; 
            margin: 0 3px;
            transition: all 0.3s ease;
            border-radius: 4px;
            padding: 4px 8px !important;
        }

        .nav-link:hover { 
            color: white !important; 
            background: rgba(255,255,255,0.1);
            transform: translateY(-1px);
        }

        .btn-primary { 
            background: var(--gradient-primary); 
            border: none; 
            box-shadow: 0 2px 8px rgba(2, 33, 65, 0.2);
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.8rem;
            padding: 0.5rem 1.5rem;
            transition: all 0.3s ease;
        }

        .btn-primary:hover { 
            background: linear-gradient(135deg, #01376d 0%, #022141 100%); 
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(2, 33, 65, 0.3);
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(2, 33, 65, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(2, 33, 65, 0.15);
        }
        
        .navbar-custom {
            background: var(--gradient-primary);
            color: rgb(255, 255, 255);
            font-size: 1rem;
            padding: 0.5rem 0;
            box-shadow: 0 2px 10px rgba(2, 33, 65, 0.3);
        }
        .navbar-custom .navbar-brand {
            color: rgb(255, 255, 255);
            font-size: 1.3rem;
            font-weight: bold;
            margin-left: 1rem;
        }
        .navbar-custom .contador-equipos {
            color: white;
            font-size: 1rem;
            font-weight: 500;
        }
        .navbar-custom .user-info {
            color: white;
            font-size: 1rem;
            display: flex;
            align-items: center;
            gap: 0.8rem;
        }
        .logout-btn {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            border-radius: 6px;
            padding: 4px 12px;
            border: none;
            color: white;
            font-size: 0.9rem;
            margin-left: 0.5rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }
        .logout-btn:hover {
            background: linear-gradient(135deg, #d90429 0%, #b00020 100%);
            transform: translateY(-1px);
        }
        .contadores-container {
            width: 100%;
            max-width: 1200px;
            margin: 24px auto 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-evenly;
            align-items: stretch;
            gap: 12px;
            background: none;
            border-radius: 0;
            box-shadow: none;
            padding: 0;
        }
        .tarjeta-mtto {
            width: 140px;
            min-width: 140px;
            max-width: 140px;
            height: 100px;
            min-height: 100px;
            max-height: 100px;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 12px;
            box-shadow: 0 3px 12px rgba(2, 33, 65, 0.12);
            border: 2px solid #e9ecef;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            transition: all 0.3s ease;
            margin: 0 8px 14px 8px;
            word-break: break-word;
            overflow: hidden;
            position: relative;
        }
        .tarjeta-mtto:hover {
            box-shadow: 0 6px 20px rgba(2, 33, 65, 0.2);
            border: 2px solid #022141;
            transform: translateY(-2px);
        }
        .tarjeta-mtto .titulo {
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 1px;
            color: #022141;
        }
        .tarjeta-mtto .valor {
            font-size: 1.05em;
            font-weight: bold;
            margin-bottom: 1px;
            color: #022141;
        }
        .tarjeta-mtto .porcentaje {
            font-size: 0.8em;
            font-weight: 500;
            margin-bottom: 1px;
            color: #022141;
        }
        .tarjeta-mtto .btn-detalles {
            font-size: 0.7em;
            font-weight: 600;
            border-radius: 5px;
            border: none;
            padding: 2px 6px;
            margin-top: 2px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #022141;
            transition: all 0.2s ease;
            text-decoration: none;
        }
        .tarjeta-mtto .btn-detalles:hover {
            background: linear-gradient(135deg, #022141 0%, #01376d 100%);
            color: #fff;
            text-decoration: none;
        }
        .tarjeta-mtto.completados {
            border: 2px solid #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }
        .tarjeta-mtto.completados .valor, .tarjeta-mtto.completados .titulo, .tarjeta-mtto.completados .porcentaje {
            color: #155724;
        }
        .tarjeta-mtto.cancelados {
            border: 2px solid #6c757d;
            background: linear-gradient(135deg, #e2e3e5 0%, #d6d8db 100%);
        }
        .tarjeta-mtto.cancelados .valor, .tarjeta-mtto.cancelados .titulo, .tarjeta-mtto.cancelados .porcentaje {
            color: #383d41;
        }
        .tarjeta-mtto.proximos {
            border: 2px solid #ffc107;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        }
        .tarjeta-mtto.proximos .valor, .tarjeta-mtto.proximos .titulo, .tarjeta-mtto.proximos .porcentaje {
            color: #856404;
        }
        .tarjeta-mtto.vencidos {
            border: 2px solid #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }
        .tarjeta-mtto.vencidos .valor, .tarjeta-mtto.vencidos .titulo, .tarjeta-mtto.vencidos .porcentaje {
            color: #721c24;
        }
        @media (max-width: 1100px) {
            .contadores-container {
                max-width: 98vw;
                gap: 8px;
            }
            .tarjeta-mtto {
                width: 42vw;
                min-width: 160px;
                max-width: 240px;
            }
        }
        @media (max-width: 700px) {
            .contadores-container {
                flex-direction: column;
                align-items: center;
            }
            .tarjeta-mtto {
                width: 85vw;
                min-width: 120px;
                max-width: 95vw;
            }
        }
        .menu-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 16px;
            margin-bottom: 16px;
        }
        .menu-item {
            margin: 8px;
            text-align: center;
        }
        .menu-item img {
            width: 80px;
            height: 80px;
            display: block;
            margin: 0 auto;
            filter: drop-shadow(0 2px 4px rgba(2, 33, 65, 0.2));
        }
        .menu-item button {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 12px;
            width: 120px;
            margin-top: 8px;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(2, 33, 65, 0.2);
        }
        .menu-item button:hover {
            background: linear-gradient(135deg, #01376d 0%, #022141 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 12px rgba(2, 33, 65, 0.3);
        }
        /* Tarjetas de mantenimientos completados recientemente con color corporativo */
        .card-mtto-reciente {
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(2, 33, 65, 0.12);
            border: 1px solid #022141;
            margin-bottom: 10px;
            transition: all 0.3s ease;
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            padding: 8px;
            font-size: 0.6rem;
            height: 100%;
        }
        .card-mtto-reciente:hover {
            box-shadow: 0 5px 15px rgba(2, 33, 65, 0.2);
            transform: translateY(-1px);
        }
        .card-mtto-reciente .titulo {
            font-weight: bold;
            font-size: 0.7rem;
            color: #022141;
            margin-bottom: 2px;
        }
        .card-mtto-reciente .usuario {
            color: #022141;
            font-weight: 500;
            font-size: 0.65rem;
            margin-bottom: 2px;
        }
        .card-mtto-reciente .fecha {
            color: #022141;
            font-size: 0.6rem;
            font-weight: 500;
            margin-bottom: 1px;
        }
        .card-mtto-reciente .tipo {
            color: #022141;
            font-size: 0.85rem;
            margin-bottom: 2px;
        }
        .badge-preventivo, .badge-correctivo, .badge-otro {
            font-size: 0.8em;
            padding: 2px 6px;
        }
        .card-mtto-reciente > div {
            margin-bottom: 2px;
        }
        /* Cambiar iconos a azul corporativo y hacerlos más pequeños */
        .card-mtto-reciente i {
            color: #022141 !important;
            font-size: 0.75em;
        }
        .contador-activo,
        .contador-final {
            min-height: 80px;
            height: 80px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .container {
            padding: 0 15px;
        }
        .mt-4 {
            margin-top: 1.5rem !important;
        }
        .mb-4 {
            margin-bottom: 1.5rem !important;
        }
        .card-header {
            padding: 0.75rem 1rem;
            font-size: 0.95rem;
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 12px 12px 0 0 !important;
        }
        .card-body {
            padding: 1rem;
        }
        .btn-sm {
            font-size: 0.8em;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
        }
        .badge-preventivo {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            border-radius: 5px;
            padding: 2px 6px;
            font-size: 0.8em;
            margin-right: 2px;
            border: 1px solid #28a745;
            font-weight: 600;
        }
        .badge-correctivo {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            color: #721c24;
            border-radius: 5px;
            padding: 2px 6px;
            font-size: 0.8em;
            margin-right: 2px;
            border: 1px solid #dc3545;
            font-weight: 600;
        }
        .badge-otro {
            background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
            color: #022141;
            border-radius: 5px;
            padding: 2px 6px;
            font-size: 0.8em;
            margin-right: 2px;
            border: 1px solid #022141;
            font-weight: 600;
        }

        .btn-outline-success {
            color: var(--success-color);
            border: 1px solid var(--success-color);
            background: transparent;
            border-radius: 6px;
            padding: 0.3rem 0.8rem;
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }

        .btn-outline-success:hover {
            background: var(--gradient-success);
            color: white;
            transform: translateY(-1px);
        }

        /* Estilos para el nuevo menú principal */
        .menu-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 16px;
            margin-bottom: 16px;
            gap: 15px;
        }
        
        .menu-item {
            margin: 8px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .menu-item:hover {
            transform: translateY(-3px);
        }
        
        .menu-item img {
            width: 80px;
            height: 80px;
            display: block;
            margin: 0 auto;
            filter: drop-shadow(0 2px 4px rgba(2, 33, 65, 0.2));
            transition: all 0.3s ease;
        }
        
        .menu-item:hover img {
            filter: drop-shadow(0 4px 8px rgba(2, 33, 65, 0.3));
            transform: scale(1.05);
        }
        
        .menu-item button {
            background: var(--gradient-primary);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 10px 15px;
            width: 140px;
            margin-top: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(2, 33, 65, 0.2);
        }
        
        .menu-item button:hover {
            background: linear-gradient(135deg, #01376d 0%, #022141 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 12px rgba(2, 33, 65, 0.3);
        }
        
        .menu-item button.btn-success {
            background: var(--gradient-success);
        }
        
        .menu-item button.btn-success:hover {
            background: linear-gradient(135deg, #388e3c 0%, #4caf50 100%);
        }
        
        .menu-item button.btn-info {
            background: var(--gradient-info);
        }
        
        .menu-item button.btn-info:hover {
            background: linear-gradient(135deg, #0097a7 0%, #00bcd4 100%);
        }
        
        .menu-item button.btn-warning {
            background: var(--gradient-warning);
        }
        
        .menu-item button.btn-warning:hover {
            background: linear-gradient(135deg, #f57c00 0%, #ff9800 100%);
        }
        
        .menu-item button.btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .menu-item button.btn-secondary:hover {
            background: linear-gradient(135deg, #495057 0%, #6c757d 100%);
        }
        
        .menu-item button.btn-dark {
            background: linear-gradient(135deg, #343a40 0%, #212529 100%);
        }
        
        .menu-item button.btn-dark:hover {
            background: linear-gradient(135deg, #212529 0%, #343a40 100%);
        }
        
        /* Estilos para accesos rápidos */
        .btn-outline-danger {
            color: #dc3545;
            border: 1px solid #dc3545;
            background: transparent;
            border-radius: 6px;
            padding: 0.3rem 0.8rem;
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }
        
        .btn-outline-danger:hover {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            transform: translateY(-1px);
        }
        
        .btn-outline-primary {
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            background: transparent;
            border-radius: 6px;
            padding: 0.3rem 0.8rem;
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }
        
        .btn-outline-primary:hover {
            background: var(--gradient-primary);
            color: white;
            transform: translateY(-1px);
        }
        
        .btn-outline-info {
            color: #17a2b8;
            border: 1px solid #17a2b8;
            background: transparent;
            border-radius: 6px;
            padding: 0.3rem 0.8rem;
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }
        
        .btn-outline-info:hover {
            background: var(--gradient-info);
            color: white;
            transform: translateY(-1px);
        }
        
        .btn-outline-secondary {
            color: #6c757d;
            border: 1px solid #6c757d;
            background: transparent;
            border-radius: 6px;
            padding: 0.3rem 0.8rem;
            font-weight: 600;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }
        
        .btn-outline-secondary:hover {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>
    <!-- Formas flotantes de fondo -->
    <div class="floating-shapes">
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <!-- Barra de navegación organizada -->
    <nav class="navbar navbar-custom">
        <div class="container-fluid d-flex justify-content-between align-items-center">
            <span class="navbar-brand"><i class="fas fa-home"></i> Inicio</span>
            {% if current_user.role != 'tecnico' %}
            <span class="contador-equipos"><i class="fas fa-cubes"></i> Total equipos: <strong>{{ total_equipos }}</strong></span>
            {% endif %}
            <div class="user-info">
                <span><i class="fas fa-user"></i> Usuario: {{ current_user.name or current_user.username }}</span>
                <button onclick="window.location.href='{{ url_for('auth.logout')}}'" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Cerrar Sesión
                </button>
            </div>
        </div>
    </nav>
    <div class="container mt-4">
      <!-- PARTE SUPERIOR: Mantenimientos completados recientemente -->
      {% if current_user.is_admin() or current_user.is_supervisor() %}
      {% if mantenimientos_completados_recientes %}
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-check-circle"></i> Mantenimientos Completados Recientemente
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                {% for mtto in mantenimientos_completados_recientes[:4] %}
                <div class="col-md-3 mb-2">
                  <div class="card-mtto-reciente">
                    <div class="usuario">
                      <i class="fas fa-user-check"></i> {{ mtto.tecnico_realizador }}
                    </div>
                    <div class="titulo">
                      <i class="fas fa-cogs"></i> <b>{{ mtto.codigo }}</b> - {{ mtto.nombre }}
                    </div>
                    <div class="tipo">
                      {% if mtto.tipo_mantenimiento == 'Preventivo' %}
                        <span class="badge-preventivo">Preventivo</span>
                      {% elif mtto.tipo_mantenimiento == 'Correctivo' %}
                        <span class="badge-correctivo">Correctivo</span>
                      {% else %}
                        <span class="badge-otro">{{ mtto.tipo_mantenimiento }}</span>
                      {% endif %}
                      <span>{{ mtto.servicio }}</span>
                    </div>
                    {% if mtto.hora_final %}
                    <div class="fecha">
                      <i class="fas fa-calendar-check"></i> {{ mtto.hora_final.strftime('%d/%m/%Y %H:%M') }}
                    </div>
                    {% endif %}
                  </div>
                </div>
                {% endfor %}
              </div>
              {% if mantenimientos_completados_recientes | length > 4 %}
              <div class="text-center mt-3">
                <a href="{{ url_for('maintenance.lista', estado_inicial='Completado') }}" class="btn btn-outline-success btn-sm">
                  <i class="fas fa-list"></i> Ver todos los mantenimientos completados
                </a>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
      {% endif %}
      {% endif %}

      <!-- PARTE CENTRAL: Menú Principal de Acceso Rápido -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-th-large"></i> Menú Principal - Acceso Rápido
              </h5>
            </div>
            <div class="card-body">
          <div class="menu-container d-flex justify-content-center flex-wrap">
                  <!-- Usuarios -->
              {% if current_user.is_admin() or current_user.is_supervisor() or current_user.is_super_admin() %}
              <div class="menu-item m-2 text-center">
                  <img src="{{ url_for('static', filename='images/user_icon.png') }}" alt="Usuarios" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('usuarios.listar_usuarios') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-users"></i> Usuarios
                      </button>
              </div>
                  {% endif %}
                  <!-- Equipos -->
              <div class="menu-item m-2 text-center">
                      <img src="{{ url_for('static', filename='images/machine_icon.png') }}" alt="Equipos" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('equipment.listar_equipos') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-cogs"></i> Equipos
                      </button>
              </div>
                  <!-- Lubricación -->
                  {% if current_user.is_admin() or current_user.is_supervisor() or current_user.is_super_admin() %}
              <div class="menu-item m-2 text-center">
                  <img src="{{ url_for('static', filename='images/lubrication_icon.png') }}" alt="Lubricación" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('lubrication.lista_cartas') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-oil-can"></i> Lubricación
                      </button>
              </div>
                  {% endif %}
                  <!-- Empresas -->
                  {% if current_user.is_admin() or current_user.is_supervisor() or current_user.is_super_admin() %}
              <div class="menu-item m-2 text-center">
                  <img src="{{ url_for('static', filename='images/empresa3_icon.png') }}" alt="Empresas" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('companies.lista') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-building"></i> Empresas
                      </button>
              </div>
              {% endif %}
                  <!-- Programador -->
                  <div class="menu-item m-2 text-center">
                      <img src="{{ url_for('static', filename='images/schedule_icon.png') }}" alt="Programador" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('maintenance.lista') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-tasks"></i> Programador
                      </button>
                  </div>
                  <!-- Auditoría -->
                  {% if current_user.is_admin() or current_user.is_super_admin() %}
              <div class="menu-item m-2 text-center">
                      <img src="{{ url_for('static', filename='images/audit_icon.jpg') }}" alt="Auditoría" style="width: 80px; height: 80px;">
                      <button onclick="window.location.href='{{ url_for('main.auditoria') }}'" class="btn btn-primary mt-2">
                          <i class="fas fa-history"></i> Auditoría
                      </button>
                  </div>
                  {% endif %}
              </div>
              </div>
          </div>
        </div>
      </div>

      <!-- PARTE INFERIOR: Contenedor de tipos de mantenimientos -->
      {% if current_user.role != 'tecnico' %}
      <div class="row">
        <div class="col-12">
          <div class="contadores-container">
            <div class="tarjeta-mtto activos">
              <div class="titulo">Activos</div>
              <div class="valor">{{ mantenimientos_activos }}</div>
              <div class="porcentaje">{{ porcentaje_activos }}%</div>
            </div>
            <div class="tarjeta-mtto completados">
              <div class="titulo">Completados</div>
              <div class="valor">{{ mantenimientos_completados }}</div>
              <div class="porcentaje">{{ porcentaje_completados }}%</div>
            </div>
            <div class="tarjeta-mtto cancelados">
              <div class="titulo">Cancelados</div>
              <div class="valor">{{ mantenimientos_cancelados }}</div>
              <div class="porcentaje">{{ porcentaje_cancelados }}%</div>
            </div>
            <div class="tarjeta-mtto proximos">
              <div class="titulo">Próximos a Vencer</div>
              <div class="valor">{{ proximos }}</div>
              <div class="porcentaje">{{ porcentaje_proximos }}%</div>
              <a href="{{ url_for('maintenance.lista', estado='Programado', fecha_inicio=fecha_inicio_proximos, fecha_fin=fecha_fin_proximos) }}" class="btn-detalles">Ver detalles</a>
            </div>
            <div class="tarjeta-mtto vencidos">
              <div class="titulo">Vencidos</div>
              <div class="valor">{{ vencidos }}</div>
              <div class="porcentaje">{{ porcentaje_vencidos }}%</div>
              <a href="{{ url_for('maintenance.lista', estado_inicial='Vencido') }}" class="btn-detalles">Ver detalles</a>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
    <!-- Pie de página con versión -->
    <footer class="text-center mt-4" style="color: #888; font-size: 0.95em; position: fixed; width: 100%; bottom: 0; left: 0; background: rgba(255,255,255,0.7); padding: 8px 0; z-index: 10;">
        Versión: {{ version }}
    </footer>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // Mejorar la interactividad del menú principal
        $(document).ready(function() {
            // Efecto de hover mejorado para los elementos del menú
            $('.menu-item').hover(
                function() {
                    $(this).find('img').addClass('pulse');
                },
                function() {
                    $(this).find('img').removeClass('pulse');
                }
            );
            
            // Agregar efecto de click a los botones
            $('.menu-item button').click(function() {
                $(this).addClass('clicked');
                setTimeout(() => {
                    $(this).removeClass('clicked');
                }, 200);
            });
            
            // Tooltip para los accesos rápidos
            $('.btn-outline-danger, .btn-outline-primary, .btn-outline-success, .btn-outline-info, .btn-outline-secondary').hover(
                function() {
                    $(this).tooltip('show');
                },
                function() {
                    $(this).tooltip('hide');
                }
            );
            
            // Animación de entrada para las tarjetas
            $('.menu-item').each(function(index) {
                $(this).css({
                    'animation-delay': (index * 0.1) + 's',
                    'animation': 'fadeInUp 0.6s ease forwards'
                });
            });
        });
        
        // Agregar estilos de animación
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            
            .pulse {
                animation: pulse 0.6s ease-in-out;
            }
            
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1.05); }
            }
            
            .clicked {
                transform: scale(0.95) !important;
                transition: transform 0.1s ease !important;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html> 